# Exploiting GPOs

<figure><img src="../../.gitbook/assets/image (11).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>

## Exploiting GPOs

```
C:\>runas /netonly /user:za.tryhackme.loc\<AD Username> cmd.exe
C:\>mmc

```

We now want to add the Group Policy Management snap-in:

1. Click File -> Add/Remove Snap-in
2. Select the Group Policy Management snap-in and click Add
3. Click Ok

<figure><img src="../../.gitbook/assets/image (13).png" alt=""><figcaption></figcaption></figure>

We can now navigate to the GPO that our user has permission to modify (Servers > Management Servers> Management Server Pushes).

<figure><img src="../../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

We can right-click on the GPO and select Edit. This will open the new Group Policy Management Editor window.

<figure><img src="../../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

In order to add our account to the local groups, we need to perform the following steps:

1. Expand Computer Configuration
2. Expand Policies
3. Expand Windows Settings
4. Expand Security Settings
5. Right Click on Restricted Groups and select Add Group (If the IT Support group already exists, it means someone has already performed the exploit. You can either delete it to create it yourself, or just inspect it to see what was configured.)\

6. Click Browse, enter IT Support and  click Check Names
7. Click Okay twice

<figure><img src="../../.gitbook/assets/image (16).png" alt=""><figcaption></figcaption></figure>

The first filter is not used. For the second filter, we want to add both the Administrators and Remote Desktop Users groups. In the end, it should look something like this:

\
![](<../../.gitbook/assets/image (17).png>)

Once the configuration has been made, we can click Apply and OK. Now, all we need to do is wait for a maximum of 15 minutes for the GPO to be applied. After this, our initial account that we made a member of the IT Support group will now have administrative and RDP permissions on THMSERVER2!
